<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçï</text></svg>"
    />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <title>Fast React Pizza Co.</title>

  <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
  <script>
  window.googletag = window.googletag || { cmd: [] };
  
  googletag.cmd.push(() => {
      googletag.enableServices();
  });
  class CrackleDiv extends HTMLElement {
      static observedAttributes = ["id", "width", "height", "background", "display", "visibility"];
      loadDivAd = []
      crackle_source_div_0 = document.createElement("div");
      crackle_source_div_1 = document.createElement("div");
      curr_active_div_counter = 0

      constructor() {
          super();
          this.crackle_source_div_0.id = "crackle_source_div_0";
          this.crackle_source_div_1.id = "crackle_source_div_1";

          googletag.cmd.push(() => {
              googletag.defineSlot("/6355419/Travel/Europe/France/Paris", [300, 250], "crackle_source_div_0").addService(googletag.pubads());
              googletag.defineSlot("/23043175892/P12344/garvit_250_300", [300, 250], "crackle_source_div_1").addService(googletag.pubads());
          });

          this.crackleCacheAd()
          this.crackleCacheAd()

          setTimeout(() => {
              console.log("Calling display for the first time")
              this.crackleDisplayAd();
          }, 10000);

          setTimeout(() => {
              console.log("Calling display for the second time")
              this.crackleDisplayAd();
          }, 20000);
      }

      connectedCallback() {
          console.log("Custom element added to page.");
          this.append(this.crackle_source_div_0)
          this.append(this.crackle_source_div_1)
      }

      disconnectedCallback() {
          console.log("Custom element removed from page.");
      }

      adoptedCallback() {
          console.log("Custom element moved to new page.");
      }

      attributeChangedCallback(name, oldValue, newValue) {
          console.log(`Attribute ${name} has changed.`);
      }

      gamAdLoad(curr_active_div) {
          console.log("gamAdLoad")
          console.log(curr_active_div.id)
          googletag.cmd.push(() => {
              googletag.display(curr_active_div.id);
          });
      }
 
      crackleCacheAd() {
          var curr_active_div = this.curr_active_div_counter == 0 ? this.crackle_source_div_0 : this.crackle_source_div_1
          this.curr_active_div_counter = (this.curr_active_div_counter+1) % 2

          curr_active_div.style.display = "none";
          curr_active_div.style.visibility = "hidden"
          this.gamAdLoad(curr_active_div);
          this.loadDivAd.push(curr_active_div)
      }

      crackleLoadAd() {
          if(this.loadDivAd.length<=0){
              this.crackleCacheAd()
          } else {
              var loadedAd = this.loadDivAd.shift();
              return loadedAd
          }
      }

      crackleDisplayAd() {
          var loadedAd = this.crackleLoadAd()
          this.children[this.curr_active_div_counter].style.visibility = "hidden"
          this.children[this.curr_active_div_counter].style.display = "none"
          this.children[this.curr_active_div_counter].style.width = "0px";
          this.children[this.curr_active_div_counter].style.height = "0px";

          loadedAd.style.visibility = "visible"
          loadedAd.style.display = "block"
          loadedAd.style.width = "300px";
          loadedAd.style.height = "250px";
          console.log(loadedAd)
      }
  }

  customElements.define("crackle-div", CrackleDiv);

  </script>

  </head>
  <body class="bg-stone-100 text-stone-700">
    <div id="root"></div>
    <div style="display: flex; align-items: center; background-color: rgb(255, 255, 0); justify-content: center; height: 500px; width: 1000px;">
      <crackle-div id="banner_ad_slot" ></crackle-div>
    </div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
